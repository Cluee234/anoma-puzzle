<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Anoma Puzzle ‚Äî Secret Number (1‚Äì100)</title>
<style>
  :root{
    --anoma-red:#ff2b2b;
    --bg:#070707;
    --card:#131313;
    --muted:#dcdcdc;
    --white:#ffffff;
  }
  html,body{height:100%;margin:0;background:var(--bg);font-family:Inter, Arial, sans-serif;color:var(--white);display:flex;align-items:center;justify-content:center;padding:18px;}
  .card{width:100%;max-width:720px;background:linear-gradient(180deg, rgba(255,43,43,0.03), rgba(0,0,0,0.22)), var(--card);border:1px solid rgba(255,43,43,0.12);border-radius:14px;box-shadow:0 12px 40px rgba(0,0,0,0.7);padding:22px;}
  header{display:flex;align-items:center;gap:12px;margin-bottom:6px;}
  h1{margin:0;color:var(--anoma-red);font-size:1.25rem;}
  .lead{margin:0;color:var(--muted);font-size:0.95rem;margin-bottom:6px;}
  .timer-wrap{height:12px;background:rgba(255,255,255,0.03);border-radius:8px;overflow:hidden;margin:14px 0 10px;position:relative;}
  .timer-bar{height:100%;background:linear-gradient(90deg,var(--anoma-red), #ff7b7b);width:100%;transition:width 0.9s linear;}
  #timerLabel{margin-bottom:12px;font-weight:700;color:#ffdede;}
  .top-stats{display:flex;gap:14px;align-items:center;margin-bottom:12px;color:#ffdede;font-weight:600;}
  .small{font-weight:500;color:#f7dcdc;font-size:0.95rem;}
  .questions{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:12px;}
  .hint-btn{
    padding:10px 14px;
    border-radius:10px;
    border:none;
    background:var(--anoma-red);
    color:#111;
    font-weight:700;
    cursor:pointer;
    min-width:170px;
    flex:1 1 calc(33% - 10px);
    transition: filter 0.3s ease;
  }
  .hint-btn:hover:not(:disabled){opacity:0.85;}
  .hint-btn:disabled{cursor:not-allowed;}
  .clues{background:rgba(255,255,255,0.02);padding:12px;border-radius:10px;min-height:70px;color:var(--muted);margin-bottom:12px;overflow:auto; display: flex; flex-direction: column-reverse;}
  .controls{display:flex;gap:10px;align-items:center;margin-bottom:8px;}
  input[type="number"]{flex:1;padding:10px 12px;border-radius:10px;border:2px solid rgba(255,43,43,0.12);background:#100606;color:var(--white);font-size:1rem;}
  #submitBtn{padding:10px 14px;border-radius:10px;border:none;background:var(--anoma-red);color:#111;font-weight:700;cursor:pointer;}
  #submitBtn:disabled{opacity:0.6;cursor:not-allowed;}
  #message{margin-top:10px;font-weight:700;min-height:40px;}
  #tryBtn{display:none;margin-top:12px;padding:8px 12px;border-radius:10px;border:1px solid rgba(255,43,43,0.14);background:#111;color:var(--anoma-red);cursor:pointer;font-weight:700;}
  #restartBtn{display:none;margin-top:12px;padding:10px 14px;border-radius:10px;border:none;background:#ff4a4a;color:#111;cursor:pointer;font-weight:700;}
  .footer-note{font-size:0.85rem;color:#d9d9d9;margin-top:10px}
  @media (max-width:640px){ .hint-btn{flex:1 1 100%;min-width:0;} .controls{flex-direction:column;} #submitBtn{width:100%;} }
</style>
</head>
<body>
  <div class="card" role="main" aria-label="Anoma Puzzle">
    <header><h1>üîÆ Anoma Puzzle</h1><div style="flex:1"></div></header>
    <p class="lead">Prove you know the secret number (1‚Äì100). Ask up to 5 hints per round. Submit your guess before time runs out.</p>

    <div class="timer-wrap" aria-hidden="true"><div id="timerBar" class="timer-bar"></div></div>
    <div id="timerLabel">Time left: <span id="timeLeft">50</span>s</div>

    <div class="top-stats">
      <div class="small">Rounds: <span id="attemptsCount">0</span></div>
      <div class="small">Score: <span id="scoreCount">0</span></div>
      <div style="flex:1"></div>
    </div>

    <div class="questions" role="group" aria-label="Hint buttons">
      <button class="hint-btn" data-type="evenOdd">Even / Odd</button>
      <button class="hint-btn" data-type="div2">Divisible by 2</button>
      <button class="hint-btn" data-type="div3">Divisible by 3</button>
      <button class="hint-btn" data-type="prime">Prime?</button>
      <button class="hint-btn" data-type="gt20">Greater than 20?</button>
      <button class="hint-btn" data-type="gt50">Greater than 50?</button>
    </div>

    <div class="clues" id="clues" aria-live="polite"><em>No hints yet ‚Äî click a hint above.</em></div>

    <div class="controls">
      <input id="guessInput" type="number" min="1" max="100" placeholder="Enter your guess (1‚Äì100)" aria-label="Guess number" />
      <button id="submitBtn">Submit Guess</button>
    </div>

    <div id="message" role="status" aria-live="polite"></div>
    <button id="tryBtn">üîÑ New Round</button>
    <button id="restartBtn">‚ôªÔ∏è Restart Game</button>
    <div class="footer-note">Hints disable after one use per round. Sounds play on success/failure (allow audio in browser).</div>
  </div>

  <!-- sounds -->
  <audio id="successAudio" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg" preload="auto"></audio>
  <audio id="failAudio" src="https://actions.google.com/sounds/v1/cartoon/boing.ogg" preload="auto"></audio>

<script>
(() => {
  const RANGE_MIN = 1, RANGE_MAX = 100;
  const START_SECONDS = 50;
  const MAX_HINTS_PER_ROUND = 5;
  const MAX_ROUNDS = 3;

  let secret = null;
  let timeLeft = START_SECONDS;
  let timerId = null;
  let usedHints = new Set();
  let hintsUsedCount = 0;
  let score = 0;
  let rounds = 0;

  const timerBar = document.getElementById('timerBar');
  const timeLabel = document.getElementById('timeLeft');
  const attemptsEl = document.getElementById('attemptsCount');
  const scoreEl = document.getElementById('scoreCount');
  const hintBtns = Array.from(document.querySelectorAll('.hint-btn'));
  const cluesEl = document.getElementById('clues');
  const guessInput = document.getElementById('guessInput');
  const submitBtn = document.getElementById('submitBtn');
  const messageEl = document.getElementById('message');
  const tryBtn = document.getElementById('tryBtn');
  const restartBtn = document.getElementById('restartBtn');
  const successAudio = document.getElementById('successAudio');
  const failAudio = document.getElementById('failAudio');

  function randInt(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }
  function isPrime(n){ if(n<2)return false; for(let i=2;i<=Math.sqrt(n);i++) if(n%i===0) return false; return true; }
  function setMessage(text, tone){
    messageEl.textContent = text;
    if(tone==='ok') messageEl.style.color = '#c8ffd8';
    else if(tone==='warn') messageEl.style.color = '#ffdca3';
    else if(tone==='err') messageEl.style.color = '#ffb3b3';
    else messageEl.style.color = '#fff';
  }

  function renderStats(){
    attemptsEl.textContent = String(rounds);
    scoreEl.textContent = String(score);
  }

  function renderHints(){
    hintBtns.forEach(btn => {
      const t = btn.dataset.type;
      if(usedHints.has(t)){
        btn.disabled = true;
        btn.style.display = 'none';
        btn.style.filter = 'none';
      } else {
        btn.style.display = '';
        btn.disabled = false;
        btn.style.filter = 'none';
      }
    });

    if(hintsUsedCount >= MAX_HINTS_PER_ROUND){
      const leftover = hintBtns.filter(b => !usedHints.has(b.dataset.type));
      if(leftover.length === 1){
        leftover[0].disabled = true;
        leftover[0].style.filter = 'blur(2px)';
        leftover[0].style.display = '';
      } else if(leftover.length > 1){
        leftover.forEach(b => {
          b.disabled = true;
          b.style.filter = 'blur(2px)';
          b.style.display = '';
        });
      }
    }

    if(hintsUsedCount > 0){
      cluesEl.innerHTML = '';
    } else {
      cluesEl.innerHTML = '<em>No hints yet ‚Äî click a hint above.</em>';
    }
  }

  function renderTimer(){
    const pct = Math.max(0, (timeLeft / START_SECONDS) * 100);
    timerBar.style.width = pct + '%';
    timeLabel.textContent = String(timeLeft);
  }

  function startRound(){
    if(rounds >= MAX_ROUNDS){
      setMessage(`üèÜ Game over! Your total score: ${score} / ${MAX_ROUNDS}. Click "Restart Game" to play again.`, 'ok');
      guessInput.disabled = true; submitBtn.disabled = true;
      hintBtns.forEach(b => { b.disabled = true; b.style.display = 'none'; b.style.filter = 'none'; });
      tryBtn.style.display = 'none';
      restartBtn.style.display = 'inline-block';
      return;
    }

    secret = randInt(RANGE_MIN, RANGE_MAX);
    usedHints.clear();
    hintsUsedCount = 0;
    timeLeft = START_SECONDS;
    clearInterval(timerId);
    timerId = setInterval(tick, 1000);
    guessInput.disabled = false; submitBtn.disabled = false;
    tryBtn.style.display = 'none';
    restartBtn.style.display = 'none';
    cluesEl.innerHTML = '<em>No hints yet ‚Äî click a hint above.</em>';
    setMessage('', null);
    renderHints(); renderStats(); renderTimer();
    guessInput.value = '';
  }

  function endRound(won){
    clearInterval(timerId);
    rounds += 1;
    renderStats();
    guessInput.disabled = true; submitBtn.disabled = true;
    tryBtn.style.display = 'inline-block';

    if(won){
      setMessage('üéâ Correct ‚Äî round complete. Start a new round when ready.', 'ok');
      try{ successAudio.currentTime = 0; successAudio.play().catch(()=>{}); }catch(e){}
      score += 1;
      renderStats();
    } else {
      setMessage(`‚è≥ Time's up ‚Äî the number was ${secret}.`, 'err');
      try{ failAudio.currentTime = 0; failAudio.play().catch(()=>{}); }catch(e){}
    }
  }

  function tick(){
    timeLeft--;
    if(timeLeft < 0) timeLeft = 0;
    renderTimer();
    if(timeLeft <= 0) endRound(false);
  }

  function handleHint(type, btn){
    if(timeLeft <= 0) return;
    if(usedHints.has(type) || hintsUsedCount >= MAX_HINTS_PER_ROUND) return;

    let text = '';
    if(type === 'evenOdd') text = (secret % 2 === 0) ? 'It is even.' : 'It is odd.';
    else if(type === 'div2') text = (secret % 2 === 0) ? 'Yes ‚Äî divisible by 2.' : 'No ‚Äî not divisible by 2.';
    else if(type === 'div3') text = (secret % 3 === 0) ? 'Yes ‚Äî divisible by 3.' : 'No ‚Äî not divisible by 3.';
    else if(type === 'prime') text = isPrime(secret) ? 'Yes ‚Äî it is prime.' : 'No ‚Äî it is not prime.';
    else if(type === 'gt20') text = (secret > 20) ? 'Yes ‚Äî greater than 20.' : 'No ‚Äî 20 or below.';
    else if(type === 'gt50') text = (secret > 50) ? 'Yes ‚Äî greater than 50.' : 'No ‚Äî 50 or below.';

    const node = document.createElement('div');
    node.textContent = text;
    cluesEl.appendChild(node);

    usedHints.add(type);
    hintsUsedCount++;

    btn.disabled = true;
    btn.style.display = 'none';

    renderHints();
  }

  function submitGuess(){
    if(timeLeft <= 0) return;
    const val = parseInt(guessInput.value, 10);
    if(!val || val < RANGE_MIN || val > RANGE_MAX){
      setMessage(`Please enter a number between ${RANGE_MIN} and ${RANGE_MAX}.`, 'warn');
      try{ failAudio.currentTime = 0; failAudio.play().catch(()=>{}); }catch(e){}
      return;
    }
    if(val === secret){
      endRound(true);
    } else {
      setMessage(val < secret ? '‚ùå Too low ‚Äî try again.' : '‚ùå Too high ‚Äî try again.', 'warn');
      try{ failAudio.currentTime = 0; failAudio.play().catch(()=>{}); }catch(e){}
    }
  }

  function tryNewRound(){
    if(rounds < MAX_ROUNDS){
      startRound();
      setMessage('', null);
      tryBtn.style.display = 'none';
      restartBtn.style.display = 'none';
    }
  }

  function restartGame(){
    score = 0;
    rounds = 0;
    setMessage('', null);
    tryBtn.style.display = 'none';
    restartBtn.style.display = 'none';
    renderStats();
    startRound();
  }

  hintBtns.forEach(btn => {
    btn.addEventListener('click', () => handleHint(btn.dataset.type, btn));
  });
  submitBtn.addEventListener('click', submitGuess);
  tryBtn.addEventListener('click', tryNewRound);
  restartBtn.addEventListener('click', restartGame);

  // Start initial round on load
  startRound();

})();
</script>
</body>
</html>
