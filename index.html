<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Anoma Puzzle ‚Äî Secret Number</title>
<style>
  :root{
    --anoma-red: #ff2b2b;
    --anoma-dark: #0b0b0b;
    --card: #1b0f0f;
    --muted: #ddd;
  }
  html,body{height:100%;margin:0;background:var(--anoma-dark);font-family:Inter,Arial,sans-serif;color:#fff;display:flex;align-items:center;justify-content:center;padding:20px;}
  .card{
    width:100%;
    max-width:520px;
    background:linear-gradient(180deg, rgba(255,0,0,0.03), rgba(0,0,0,0.2)), var(--card);
    border:1px solid rgba(255,43,43,0.18);
    border-radius:14px;
    box-shadow:0 10px 40px rgba(0,0,0,0.7);
    padding:22px;
  }
  h1{margin:0 0 10px;color:var(--anoma-red);font-size:1.25rem;}
  p.lead{margin:0 0 14px;color:var(--muted);line-height:1.35;}
  #timer{font-weight:700;color:#ffdcdc;margin-bottom:12px;}
  .questions{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:14px;}
  .qBtn{
    flex:1 1 calc(50% - 8px);
    min-width:140px;
    padding:10px 12px;
    border-radius:10px;
    border:none;
    background:var(--anoma-red);
    color:#fff;
    font-weight:700;
    cursor:pointer;
  }
  .qBtn[disabled]{background:#4a0a0a;cursor:not-allowed;opacity:0.9;}
  #attempts{color:#ffdede;font-weight:700;margin-bottom:10px;}
  #answers{background:rgba(255,255,255,0.02);padding:10px;border-radius:8px;max-height:140px;overflow:auto;margin-bottom:12px;color:var(--muted);}
  .controls{display:flex;gap:10px;align-items:center;margin-bottom:10px;}
  input[type="number"]{
    flex:1;
    padding:10px 12px;border-radius:10px;border:2px solid rgba(255,43,43,0.25);background:#100606;color:#fff;font-size:1rem;
  }
  #submitBtn{
    padding:10px 14px;border-radius:10px;border:none;background:var(--anoma-red);color:#fff;font-weight:700;cursor:pointer;
  }
  #submitBtn:disabled{background:#4a0a0a;cursor:not-allowed;}
  #result{margin-top:12px;font-weight:700;min-height:38px;}
  #tryAgain{display:none;margin-top:12px;padding:8px 12px;border-radius:10px;border:none;background:#222;color:var(--anoma-red);cursor:pointer;}
  .small{font-size:0.9rem;color:#e6dede;margin-top:8px;}
  @media (max-width:420px){ .qBtn{flex:1 1 100%;} .controls{flex-direction:column;align-items:stretch;} }
</style>
</head>
<body>
  <div class="card" role="main" aria-label="Anoma Puzzle">
    <h1>üîÆ Anoma Puzzle</h1>
    <p class="lead">Prove you know the secret number between <strong>1</strong> and <strong>1000</strong>. Ask up to <strong>5</strong> yes/no questions, then submit your guess before time runs out.</p>

    <div id="timer">Time left: 20s</div>

    <div id="attempts">Attempts left: 5</div>

    <div class="questions" aria-label="Question buttons">
      <button class="qBtn" data-q="gt500">Is it greater than 500?</button>
      <button class="qBtn" data-q="evenOdd">Is it even or odd?</button>
      <button class="qBtn" data-q="prime">Is it prime?</button>
      <button class="qBtn" data-q="div2">Is it divisible by 2?</button>
      <button class="qBtn" data-q="div3">Is it divisible by 3?</button>
    </div>

    <div id="answers" aria-live="polite" aria-atomic="false"><em>No clues yet ‚Äî ask a question.</em></div>

    <div class="controls">
      <input id="guessInput" type="number" min="1" max="1000" placeholder="Enter your guess (1‚Äì1000)" aria-label="Guess number" />
      <button id="submitBtn">Submit Guess</button>
    </div>

    <div id="result" role="status" aria-live="polite"></div>

    <button id="tryAgain">üîÑ Try Again</button>
    <div class="small">Note: sounds play on success/failure (allow audio in your browser).</div>
  </div>

  <!-- sounds -->
  <audio id="successAudio" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg" preload="auto"></audio>
  <audio id="failAudio" src="https://actions.google.com/sounds/v1/cartoon/boing.ogg" preload="auto"></audio>

<script>
(() => {
  // --- config ---
  const MAX_ATTEMPTS = 5;
  const START_TIME = 20; // seconds

  // --- state ---
  let secretNumber = null;
  let attemptsUsed = 0;
  let answersLog = [];
  let timeLeft = START_TIME;
  let timerId = null;
  let gameOver = false;

  // --- elements ---
  const timerEl = document.getElementById('timer');
  const attemptsEl = document.getElementById('attempts');
  const answersEl = document.getElementById('answers');
  const qButtons = Array.from(document.querySelectorAll('.qBtn'));
  const guessInput = document.getElementById('guessInput');
  const submitBtn = document.getElementById('submitBtn');
  const resultEl = document.getElementById('result');
  const tryAgainBtn = document.getElementById('tryAgain');
  const successAudio = document.getElementById('successAudio');
  const failAudio = document.getElementById('failAudio');

  // --- helpers ---
  function randInt(min, max){ return Math.floor(Math.random()*(max-min+1))+min; }
  function isPrime(n){
    if(n < 2) return false;
    for(let i=2;i<=Math.sqrt(n);i++) if(n % i === 0) return false;
    return true;
  }

  // update UI functions
  function renderAttempts(){ attemptsEl.textContent = `Attempts left: ${Math.max(0, MAX_ATTEMPTS - attemptsUsed)}`; }
  function renderAnswers(){
    if(answersLog.length === 0){ answersEl.innerHTML = '<em>No clues yet ‚Äî ask a question.</em>'; return; }
    answersEl.innerHTML = '<ul>' + answersLog.map(a => `<li>${a}</li>`).join('') + '</ul>';
  }
  function disableQuestionButtons(){
    qButtons.forEach(b=> b.disabled = true);
  }
  function enableQuestionButtons(){
    qButtons.forEach(b=> { b.disabled = false; b.classList.remove('used'); });
  }

  // start new game
  function startGame(){
    secretNumber = randInt(1,1000);
    attemptsUsed = 0;
    answersLog = [];
    timeLeft = START_TIME;
    gameOver = false;
    guessInput.disabled = false;
    submitBtn.disabled = false;
    tryAgainBtn.style.display = 'none';
    resultEl.textContent = '';
    enableQuestionButtons();
    renderAttempts();
    renderAnswers();
    startTimer();
    // console.log('secretNumber', secretNumber); // uncomment to debug locally
  }

  // timer control
  function startTimer(){
    clearInterval(timerId);
    timerEl.textContent = `Time left: ${timeLeft}s`;
    timerId = setInterval(() => {
      timeLeft--;
      if(timeLeft < 0) timeLeft = 0;
      timerEl.textContent = `Time left: ${timeLeft}s`;
      if(timeLeft <= 0){
        clearInterval(timerId);
        onTimeUp();
      }
    }, 1000);
  }

  function onTimeUp(){
    gameOver = true;
    disableQuestionButtons();
    guessInput.disabled = true;
    submitBtn.disabled = true;
    resultEl.innerHTML = `<span style="color:#ffb3b3">‚è≥ Time's up ‚Äî game over. The number was <strong>${secretNumber}</strong>.</span>`;
    tryAgainBtn.style.display = 'inline-block';
    tryAgainBtn.focus();
    // play fail sound
    try{ failAudio.currentTime = 0; failAudio.play().catch(()=>{}); }catch(e){}
  }

  // question answering
  function answerQuestion(type, button){
    if(gameOver) return;
    if(attemptsUsed >= MAX_ATTEMPTS) return;
    if(button.disabled) return; // already used

    let text = '';
    if(type === 'gt500'){
      text = `Q: Is it greater than 500? ‚Äî A: ${secretNumber > 500 ? 'Yes' : 'No'}`;
    } else if(type === 'evenOdd'){
      text = `Hint: It is ${secretNumber % 2 === 0 ? 'even' : 'odd'}.`;
    } else if(type === 'prime'){
      text = `Q: Is it prime? ‚Äî A: ${isPrime(secretNumber) ? 'Yes' : 'No'}`;
    } else if(type === 'div2'){
      text = `Q: Is it divisible by 2? ‚Äî A: ${secretNumber % 2 === 0 ? 'Yes' : 'No'}`;
    } else if(type === 'div3'){
      text = `Q: Is it divisible by 3? ‚Äî A: ${secretNumber % 3 === 0 ? 'Yes' : 'No'}`;
    }

    answersLog.unshift(text); // newest first
    attemptsUsed++;
    renderAttempts();
    renderAnswers();

    // visually mark button used and disable it
    button.disabled = true;
    button.classList.add('used');

    // if out of attempts, disable all question buttons
    if(attemptsUsed >= MAX_ATTEMPTS) disableQuestionButtons();
  }

  // submit guess
  function submitGuess(){
    if(gameOver) return;
    const val = parseInt(guessInput.value, 10);
    if(!val || val < 1 || val > 1000){
      resultEl.innerHTML = `<span style="color:#ffd966">Please enter a valid number between 1 and 1000.</span>`;
      try{ failAudio.currentTime = 0; failAudio.play().catch(()=>{}); }catch(e){}
      return;
    }

    if(val === secretNumber){
      gameOver = true;
      clearInterval(timerId);
      resultEl.innerHTML = `<span style="color:#c6ffdd">üéâ Proof accepted ‚Äî correct number!</span>`;
      tryAgainBtn.style.display = 'inline-block';
      try{ successAudio.currentTime = 0; successAudio.play().catch(()=>{}); }catch(e){}
      // disable inputs
      disableQuestionButtons();
      guessInput.disabled = true;
      submitBtn.disabled = true;
    } else {
      resultEl.innerHTML = `<span style="color:#ffd4a3">‚ùå Incorrect. ${val < secretNumber ? 'Try higher.' : 'Try lower.'}</span>`;
      try{ failAudio.currentTime = 0; failAudio.play().catch(()=>{}); }catch(e){}
    }
  }

  // wire up UI
  qButtons.forEach(btn => {
    btn.addEventListener('click', () => answerQuestion(btn.dataset.q, btn));
  });
  submitBtn.addEventListener('click', submitGuess);
  guessInput.addEventListener('keydown', (e) => { if(e.key === 'Enter') submitGuess(); });
  tryAgainBtn.addEventListener('click', startGame);

  // start
  startGame();

  // expose for debugging optionally: window._anoma = { startGame, secretNumber: ()=> secretNumber };
})();
</script>
</body>
</html>
